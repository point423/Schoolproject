# 校园选课系统（单体版）

## 一、项目说明
### 1.1 项目背景
本项目是学期贯穿式实践项目的初始阶段，目标是构建一个**单体架构的校园选课与教学资源管理平台**。通过该项目，可掌握Spring Boot开发流程、RESTful API设计规范及完整的CRUD操作实现，为后续扩展为微服务架构奠定基础。

### 1.2 核心功能
项目围绕“课程管理、学生管理、选课管理”三大核心模块展开，覆盖校园选课场景的基础业务需求，具体功能如下：
- **课程管理**：支持课程的查询（所有/单个）、创建、更新、删除操作，维护课程基本信息（编号、名称、教师、上课时间、容量等）。
- **学生管理**：支持学生的查询（所有/单个）、创建、更新、删除操作，自动生成学生唯一ID和创建时间戳，校验学号唯一性与邮箱格式合法性。
- **选课管理**：支持学生选课、退课及选课记录查询（全量/按课程/按学生），并实现课程容量限制、重复选课检查等业务规则。

### 1.3 技术栈
- 核心框架：Spring Boot 3.4.x（Web模块）
- 数据校验：Spring Boot Starter Validation
- 数据存储：内存存储（ConcurrentHashMap，无需数据库）
- 测试工具：Postman/Apifox/curl
- 项目构建：Maven


## 二、如何运行项目
### 2.1 环境准备
- JDK版本：JDK 17及以上
- Maven版本：Maven 3.8.x及以上
- 开发工具（可选）：IntelliJ IDEA/Eclipse

### 2.2 项目获取
从Git仓库克隆项目：
   ```bash
   git clone https://github.com/point423/Schoolproject.git
   ```



## 三、API 接口列表
所有接口均返回**统一JSON格式**，成功响应`code=200`，错误响应包含对应错误码（如400/404）及提示信息。

### 3.1 课程管理 API
| 接口功能       | HTTP方法 | 接口路径                | 请求体/参数                | 响应说明                     |
|----------------|----------|-------------------------|----------------------------|------------------------------|
| 查询所有课程   | GET      | /api/courses            | 无                         | 返回所有课程列表（空列表或课程数组） |
| 查询单个课程   | GET      | /api/courses/{id}       | 路径参数：课程ID           | 成功返回课程详情，失败返回404（课程不存在） |
| 创建课程       | POST     | /api/courses            | Content-Type: application/json<br>示例：<br>{<br>"code":"CS101",<br>"title":"计算机科学导论",<br>"instructor":{"id":"T001","name":"张教授","email":"zhang@example.edu.cn"},<br>"schedule":{"dayOfWeek":"MONDAY","startTime":"08:00","endTime":"10:00","expectedAttendance":50},<br>"capacity":60<br>} | 成功返回201（创建成功），失败返回400（参数缺失） |
| 更新课程       | PUT      | /api/courses/{id}       | 路径参数：课程ID<br>请求体：同创建课程（按需修改字段） | 成功返回200（更新后课程），失败返回404（课程不存在） |
| 删除课程       | DELETE   | /api/courses/{id}       | 路径参数：课程ID           | 成功返回204（无内容）或200，失败返回404 |

### 3.2 学生管理 API
| 接口功能       | HTTP方法 | 接口路径                | 请求体/参数                | 响应说明                     |
|----------------|----------|-------------------------|----------------------------|------------------------------|
| 创建学生       | POST     | /api/students           | Content-Type: application/json<br>示例：<br>{<br>"studentId":"2024001",<br>"name":"李同学",<br>"major":"计算机科学与技术",<br>"grade":2024,<br>"email":"li@example.edu.cn"<br>} | 成功返回201（含系统生成的id和createdAt），失败返回400（学号重复/邮箱格式错误/参数缺失） |
| 查询所有学生   | GET      | /api/students           | 无                         | 返回所有学生列表（空列表或学生数组） |
| 查询单个学生   | GET      | /api/students/{id}      | 路径参数：学生ID（系统生成的UUID） | 成功返回学生详情，失败返回404（学生不存在） |
| 更新学生       | PUT      | /api/students/{id}      | 路径参数：学生ID<br>请求体：同创建学生（按需修改字段） | 成功返回200（更新后学生），失败返回404（学生不存在）或400（学号重复/邮箱格式错误） |
| 删除学生       | DELETE   | /api/students/{id}      | 路径参数：学生ID           | 成功返回204或200，失败返回404（学生不存在）或400（存在选课记录） |

### 3.3 选课管理 API
| 接口功能       | HTTP方法 | 接口路径                | 请求体/参数                | 响应说明                     |
|----------------|----------|-------------------------|----------------------------|------------------------------|
| 学生选课       | POST     | /api/enrollments        | Content-Type: application/json<br>示例：<br>{<br>"courseId":"课程ID",<br>"studentId":"2024001"<br>} | 成功返回201（选课记录），失败返回400（容量已满/重复选课）或404（课程/学生不存在） |
| 学生退课       | DELETE   | /api/enrollments/{id}   | 路径参数：选课记录ID       | 成功返回204或200，失败返回404（选课记录不存在） |
| 查询所有选课记录 | GET      | /api/enrollments        | 无                         | 返回所有选课记录列表         |
| 按课程查询选课记录 | GET    | /api/enrollments/course/{courseId} | 路径参数：课程ID | 返回该课程的所有选课记录，失败返回404（课程不存在） |
| 按学生查询选课记录 | GET    | /api/enrollments/student/{studentId} | 路径参数：学生学号（如2024001） | 返回该学生的所有选课记录，失败返回404（学生不存在） |


## 四、测试说明
### 4.1 测试工具
推荐使用 **Postman** 或 **Apifox**（可视化工具），或通过 `curl` 命令行测试。

### 4.2 核心测试场景
需覆盖以下4类场景，确保功能完整性与业务规则有效性：

#### 场景1：完整课程管理流程
1. **创建课程**：调用`POST /api/courses`，传入3门不同课程的参数，验证返回201。
2. **查询所有课程**：调用`GET /api/courses`，验证返回3条课程记录。
3. **查询单个课程**：使用某课程ID调用`GET /api/courses/{id}`，验证返回该课程详情。
4. **更新课程**：调用`PUT /api/courses/{id}`修改课程名称/容量，验证返回更新后信息。
5. **删除课程**：调用`DELETE /api/courses/{id}`，验证返回204/200。
6. **验证删除结果**：再次查询该课程ID，验证返回404。

#### 场景2：选课业务流程
1. **创建课程**：调用`POST /api/courses`，创建容量为2的课程。
2. **学生1选课**：调用`POST /api/enrollments`，传入学生1学号与课程ID，验证成功。
3. **学生2选课**：同上，传入学生2信息，验证成功。
4. **学生3选课**：同上，传入学生3信息，验证返回400（容量已满）。
5. **重复选课**：学生1再次选同一课程，验证返回400（重复选课）。
6. **验证选课人数**：查询该课程详情，验证`enrolled`字段为2。

#### 场景3：学生管理流程
1. **创建学生**：调用`POST /api/students`，创建3个不同学号的学生（如2024001/2024002/2024003），验证返回201。
2. **查询所有学生**：调用`GET /api/students`，验证返回3条学生记录。
3. **查询单个学生**：使用学生1的系统ID调用`GET /api/students/{id}`，验证返回正确信息。
4. **更新学生**：调用`PUT /api/students/{id}`修改学生1的专业和邮箱，验证返回更新后信息。
5. **无效选课**：使用不存在的学生学号调用`POST /api/enrollments`，验证返回404。
6. **删除有选课记录的学生**：学生1选课后，调用`DELETE /api/students/{id}`，验证返回400（存在选课记录）。
7. **删除无选课记录的学生**：调用`DELETE /api/students/{id}`删除学生3，验证返回204/200。

#### 场景4：错误处理验证
1. **查询不存在的资源**：调用`GET /api/courses/999`（不存在的ID），验证返回404。
2. **参数缺失**：创建课程时不传入`title`字段，验证返回400。
3. **无效邮箱**：创建学生时传入`email="li.example.com"`，验证返回400。
4. **学号重复**：创建学生时使用已存在的`studentId`，验证返回400。
5. **无效课程选课**：选课时传入不存在的`courseId`，验证返回404。

### 4.3 测试文档提交
需生成测试文档（支持Markdown或HTTP文件），记录以下内容：
- 每个测试场景的**请求URL、请求方法、请求体/参数**。
- 实际响应的**状态码、响应体**。
- 测试中遇到的问题（如接口报错）及解决方案（如参数校验逻辑修正）。

